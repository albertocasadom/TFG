European Union Agency Network Information Security www.enisa.europa.eu Presenting correlating filtering various feeds Toolset Document students September 2013 Presenting correlating filtering various feeds Toolset Document students September 2013 Page ii About ENISA The European Union Agency Network Information Security ENISA centre network information security expertise EU Member States citizens ENIS A works groups develop advice recommendations good practice information security It assists EU Member States implementing relevant EU legislation works e networks ENISA seeks enhance existing expertise EU Member States supporting development cross - border communities committed improving network information security throughout EU More information ENISA work found www.enisa.europa.eu Authors This document created CERT capability team ENISA consultation Don Stikvoort Alan Thomas Robinson S - Tomasz Reijers Rubicon Projects The Netherlands Mirko Wollenberg DFN - CERT Services Germany Contact For contacting authors please use CERT - Relations @ enisa.europa.eu For media enquires document please use press @ enisa.europa.eu Acknowledgements ENISA wants thank institutions pers ons contributed document A 1 Tomas Lima CERT.PT 2 The countless people reviewed document Presenting correlating filtering various feeds Toolset Document students September 2013 Page iii Legal notice Notice must taken publication represents views interpretations authors editors unless stated otherwise This publication construed legal action ENISA ENISA bodies unless adopted pursuant Regulation EU No 526/2013 This publication necessarily represent state - - art ENISA may update time time Third - party sources quoted appropriate ENISA responsible content external sources inc luding external websites referenced publication This publication intended information purposes It must accessible free charge Neither ENISA person acting behalf responsible use might made information contained publication Copyright Notice Â© European Union Agency Network Information Security ENISA 2013 Reproduction authorised provided source acknowledged ISBN 978 - 92 - 79 - 00077 - 5 doi:10.2788/14231 Presenting correlating filtering various feeds Toolset Document students September 2013 Page iv Table Contents 2 Introduction 1 3 Exercise tasks 1 3.1 Setup 1 3.1.1 Task 1 Identifying data sources 1 3.1.2 Task 2 Using Kibana 1 3 1.3 Task 3 Tracing cybercrime activity 2 4 Conclusion 3 5 References 4 Presenting correlating filtering various feeds Toolset Document students September 2013 Page 1 1 What learn In exercise gain overview data visualisation approaches Based upon AbuseHelper see also exercise 14 Proactive Incident Detection visualisation provided Kibana related tools introduced detail The necessary material exercise located folder /usr/share/trainee/28_VCT ENISA virtual appl iance repeated document Figure 1 Kibana web interface 2 Introduction During introduction trainer familiarise topic data visualisation different solutions implementations visualisation tools used main section exercise Your main tool Kibana provides web interface implementing Apache Lucene syntax 3 Exercise tasks 3.1 S etup Before start working tasks necessary initialise working environment properly Follow instructions given trainer find necessary commands After setup three tasks processed 3.1.1 Task 1 Identifying data sources Use spread sheet AH - data - feed - eval.xls main folder exercise Fill fields taking particular care reasoning regard usability fo r cybercrime investigations 3.1.2 Task 2 Using Kibana Use Kibana web frontend answer following questions Which feeds configured ? Which ASN incoming data fields ? Which ASN distributing malware ? Which three ASN phishing incidents ? Presenting correlating filtering various feeds Toolset Document students September 2013 Page 2 Write results document steps taken achieve goals Describe constraints visualisation approach advantages approach Give rating regarding use Kibana incident response teams 3.1.3 Task 3 Tracing cybercrime activity Although meant full - scale role - play exercise background information help understand data analysed context incidents Backg round information regarding context data You incident response team company providing e - commerce solutions It hosts business infrastructure site shop solution payment customers software service SaaS 1 mode l. The sites hosts generate daily Technical details technical infrastructure company This information necessary analyse incident data 1 Domain example.com 2 Network 192.0.32.0/20 3 Autonomous S ystem Number ASN 2 AS26711 4 Apache Webserver 5 ModSecurity intrusion detection system IDS Three data sets prepared containing incident related information These reside folders event_1 event_2 event_3 /usr/share/trainee/28_VCT/add named event - log.csv Inject running visualisation installation requested trainer see commands document details Answer following questions The customers based EU logins networks outside Europe unusual Please check logins write anomalies Check incident data hints cause compromises For parts develop document next steps incident response process Answer followin g In data evidence next steps attackers taken initial compromise Identify incidents document information necessary steps contain respond Answer following Customers complaini ng issues webservers Check data possible causes document technical detail 1 Software Service SaaS http //cloudtaxonomy.opencrowd.com/taxonomy/software - - - service/ 2 Autonomous System AS Numbers http //www.iana.org/assignments/as - numbers/as - numbers.xhtml Presenting correlating filtering various feeds Toolset Document students September 2013 Page 3 4 Conclusion The last part exercise reviews task You start exercises team students present findi ngs process analysing data Kibana Afterwards presentations discussed participants summarised trainer document learning effect In second step Kibana alternative visualisation approaches implementations topic discussion Use notes base try also include background information outside exercise experience Finally general approach visualising data discussed Develop criteria lps decide visualise Presenting correlating filtering various feeds Toolset Document students September 2013 Page 4 5 References 1 The Honeynet Project Know Your Tools use Picviz find attacks 2009 http //www.honeynet.org/files/KYT - Picviz_v1_0.pdf 2. logstash open source log management http //logstash.net/ 3 Kibana Make sense mountain logs http //kibana.org/ 4 Elasticsearch Real Time Data Analysis http //www.elasticsearch.net/ 5. certpt GenericEvent - AbuseHelper https //bitbucket.org/certpt/genericevent - abusehelper/src 6. certpt LogCollector - AbuseHelper - E xtension https //bitbucket.org/certpt/logcollector - abusehelper - extension/overview 7 Wikipedia Information visualization https //en.wikipedia.org/wiki/Information_visualization 8 Apache Lucene Query Parser Syntax https //lucene.apache.org/core/3_5_0/queryparsersyntax.html 9 CERT.at ProcDOT http //cert.at/downloads/software/procdot_en.html 10 Wikipedia Netcat http //en.wikipedia.org/wiki/Netcat 11 ENISA Exercise Material http //www.enisa.europa.eu/activities/cert/support/exercise 12 AbuseHelper http //www.abusehelper.be/ 13 Wikipedia Graph abstract data type https //en.wikipedia.org/wiki/Graph_ % 28data_structure % 29 14 Wikipedia Par allel coordinates https //en.wikipedia.org/wiki/Parallel_coordinates 15 Wikipedia Heatmap https //en.wikipedia.org/wiki/Heatmap 16 Team Cymru Internet Malicious Activity Maps https //team - cymru.org/Monitoring/Malevolence/maps.html Presenting correlating filtering various feeds Toolset Document students September 2013 Page 5 ENISA European Union Agency Network Information Security Science Technology Park Crete ITE Vassilika Vouton 700 13 Heraklion Greece Athens Office 1 Vass Sofias & Meg Alexandrou Marousi 151 24 Athens Greece PO Box 1309 710 01 H eraklion Greece Tel +30 28 14 40 9710 info @ enisa.europa.eu www.enisa.europa.eu 